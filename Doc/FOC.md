# FOC field orientied control 

## 1. Six-step commutation of brushless DC motor
The commutation operation is triggered when the rotor is in a specific position. The commutation is passive commutation. If you want to increase the speed, you must increase the current, so that the magnetic field generated by the stator is stronger, so that the rotor can reach the target point faster and then trigger the commutation, as shown in the table below.

## 2. How to get the angle of the rotor?
We already know that we need to detect the angle first and then commutate, so how to detect the current angle? There are the following three ways. 
1. Calculate the current angle by installing the **encoder**. 
2. Calculate the current angle by installing the **Hall sensor**.
3. Calcualte the current angle **decting the current**.
   
### 2. 1 Encoder method to obtain the current angle of the motor
There are two types of encoders, incremetal encoder and absolute encoder. 

Increemtal encoder: A calibration need to be done before each startup, and in order to prever the pulse loss caused by the performence of micro controller, ther encoder needs to be calibrated once per revolution. Therefore, the ABZ three-axis encoder is often used, and the AB output the orthogonal signal, z axis output the interruption. 

Absolute encoder, only one calibration needs to be done before leaving the factory, afterwards, if there is not disassembly, no calibration required. The communication method are generally SPI and I2C, and the influence of the communication time on the system needs to be considered. Why we need to do the calibration to the encoder, because we cannot ensure that the 0 angle of the encoder just correspond to the 0 angle of the rotor (eletrical angle: in general the default electrical angle is 0)

### 2.2 Hall sensor method to obtain the angle of the motor

### 2.3 Detecting of the current to botain the angle of the motor

Because of the rotation, the motor will generate some wave. Then we can detect the current to determine which range of the current of the motor is. 

## 3. field orientied control 
### 3.1 open loop of the FOC
We can review the process of learing brust direct current motor. First we need to rotate the motor and then we need to implement hte speed control ,and implement the position o 